<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Tutorial: ARCHITECTURE</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Tutorial: ARCHITECTURE</h1>

    <section>

<header>
    

    <h2>ARCHITECTURE</h2>
</header>

<article>
    <h1>general approach</h1>
<p>The main challenge for Screeps is scoping out things and caching them in clever ways.
There are 3 levels of scope we work with:</p>
<ul>
<li>Prototype: Functions wrapped around built-in classes to enhance their functionality</li>
<li>Room: Handles running an individual room, spawning creeps and creating construction sites</li>
<li>Global: High level management that creates new rooms and counts the creeps</li>
</ul>
<p>We focus on role-base creep and structure behaviour via extensive prototyping.
We put as much of the bulk of code into prototyped functions so we can to consolidate the code and improve stability.
We should never be repeating ourselves much.
Higher level functions like population and construction are handled on a room-by-room basis, with tailored behaviour for
their type.
The Capitol room is a room that all non-energy resources are concentrated at.
Colony rooms are normal bases that have all the major structures.
Expansion rooms harvest extra energy, and are not fully owned, but reserved.
We focus on making polished features like time statistics, visuals, loggers, memory wiping, and commands.
This creates a pleasant and native experience for the player watching the colony.
We want the visuals and console to act as a neat screen-saver if desired.
Stability is a large focus, with no breaking errors and no time-outs.
We also make sure to support occasional memory wipes so that the system can recover after a fix or change to the code.
Support for build numbers allows for automatic memory wipe and recovery to prevent version differences causing breaking
changes.
All the code is in raw Javascript.
The code is kept simple to aid in teaching and readability.
No libraries, typescript, syntactic sugar, or compilation allows the code to be read by a beginner.
Nearly every single line of code is commented and explained.
The code should be self-explaining, with documentation being optional to understand it.
Documentation is optional but extensive, containing design notes as well as usage guides.</p>
<h1>file structure</h1>
<p>files are labeled in a <code>scope.name.js</code> format.
The scope specifies the type of file, and is one of the following:</p>
<ul>
<li>data - Class file that is serializable and storable in memory</li>
<li>factory - Module that has methods for creating complex data objects</li>
<li>runner - Module with methods to run a data object, effectively holding its logic</li>
<li>global - Module that is globally available and consistent, providing high-level and common operations</li>
<li>role - Creep role logic for assigning and running their tasks</li>
<li>prototype - extra functions that get added to game classes, cutting down on bloat</li>
</ul>
<h1>Task system</h1>
<p>Low level actions such as &quot;get this resource from here&quot; or &quot;idle here&quot; or &quot;build this&quot; are stored as Tasks on the Creep.
Tasks can detect when the task is done and delete themselves or restore an old task.
Decision trees are only utilized if the task is empty, this cuts down on CPU time heavily.
This also cuts down on duplicated code, reducing footprint and improving stability.
Task invalidating eliminates the need for state machines, avoiding broken states entirely.
Each creep need only ask itself: &quot;Do I have a task? If so, do it. If not, find a new task.&quot;
Only catastrophic events such as a colony dying cause broken states, which have far worse consequences than a few confused creeps.</p>
<h1>JSDoc usage</h1>
<p>All systems have JSDoc type hints to utilize IDE features for debugging.
Also helps with autocomplete and forcing documentation standards.
You can re-generate the documentation site using <code>npm run generate</code>.</p>
<h1>Roles</h1>
<p>This is a list of the creep roles that are utilized.
Each one gets some initial data in memory and then from there work independently and do not require oversight.
These are all implemented as prototypes onto the built-in Creep type to allow for native use like <code>creep.run()</code></p>
<h2>attacker</h2>
<p>Defends whatever room they are assigned to</p>
<h2>builder</h2>
<p>Builds any construction sites in the room</p>
<h2>claimer</h2>
<p>Claims or reserves the room it is assigned to, depending on the room's type</p>
<h2>commodity collector</h2>
<p>Finds commodities and returns them to the capitol</p>
<h2>driller</h2>
<p>Harvests a given energy source, standing over it's assigned container</p>
<h2>healer</h2>
<p>Heals any creeps in the assigned room</p>
<h2>mineral driller</h2>
<p>Harvests the mineral in the room, standing over it's assigned container</p>
<h2>mineral transporter</h2>
<p>Transports the mined minerals to the capitol</p>
<h2>operator power creep</h2>
<p>Able to operate factory to enable it
Transports reagents to labs and products back to storage
Transports commodities into and from the factory</p>
<h2>power attacker</h2>
<p>Attacks a power bank</p>
<h2>power healer</h2>
<p>Heals the attacker it is assigned to</p>
<h2>power transporter</h2>
<p>Follows the assigned attacker and picks up power, taking it back to the capitol</p>
<h2>queen</h2>
<p>Takes energy from the storage and puts it into the tower, extensions, or the terminal</p>
<h2>repairer</h2>
<p>Repairs any structures in the room, used before towers are unlocked</p>
<h2>scout</h2>
<p>Scouts out new rooms using simple search algorithm</p>
<h2>transporter</h2>
<p>Moves energy from assigned container back to the spawn/extensions/storage</p>
<h2>upgrader</h2>
<p>Upgrades the room's controller to level it up and maintain ownership</p>
</article>

</section>

</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-PlantRunner.html">PlantRunner</a></li><li><a href="module-PowerManager.html">PowerManager</a></li><li><a href="module-RoomPlansFactory.html">RoomPlansFactory</a></li><li><a href="module-RoomRunner.html">RoomRunner</a></li><li><a href="module-TaskRunner.html">TaskRunner</a></li><li><a href="module-Timer.html">Timer</a></li><li><a href="module-Util.html">Util</a></li><li><a href="module-Visualizer.html">Visualizer</a></li></ul><h3>Classes</h3><ul><li><a href="AttackTask.html">AttackTask</a></li><li><a href="AttackerMemory.html">AttackerMemory</a></li><li><a href="BuildTask.html">BuildTask</a></li><li><a href="BuilderMemory.html">BuilderMemory</a></li><li><a href="ClaimTask.html">ClaimTask</a></li><li><a href="ClaimerMemory.html">ClaimerMemory</a></li><li><a href="ConstructionPlan.html">ConstructionPlan</a></li><li><a href="CreepMemory.html">CreepMemory</a></li><li><a href="DepositTask.html">DepositTask</a></li><li><a href="DrillTask.html">DrillTask</a></li><li><a href="DrillerMemory.html">DrillerMemory</a></li><li><a href="GatherTask.html">GatherTask</a></li><li><a href="HealTask.html">HealTask</a></li><li><a href="HealerMemory.html">HealerMemory</a></li><li><a href="IdleTask.html">IdleTask</a></li><li><a href="MineralDrillerMemory.html">MineralDrillerMemory</a></li><li><a href="MineralPlan.html">MineralPlan</a></li><li><a href="MineralPopulation.html">MineralPopulation</a></li><li><a href="MineralTransporterMemory.html">MineralTransporterMemory</a></li><li><a href="MoveRoomTask.html">MoveRoomTask</a></li><li><a href="PlantData.html">PlantData</a></li><li><a href="Point.html">Point</a></li><li><a href="PowerSquad.html">PowerSquad</a></li><li><a href="Production.html">Production</a></li><li><a href="QueenMemory.html">QueenMemory</a></li><li><a href="Reaction.html">Reaction</a></li><li><a href="RenewOperatorTask.html">RenewOperatorTask</a></li><li><a href="RepairTask.html">RepairTask</a></li><li><a href="RepairerMemory.html">RepairerMemory</a></li><li><a href="ReserveTask.html">ReserveTask</a></li><li><a href="RoomData.html">RoomData</a></li><li><a href="RoomPlans.html">RoomPlans</a></li><li><a href="RoomPopulation.html">RoomPopulation</a></li><li><a href="ScoutMemory.html">ScoutMemory</a></li><li><a href="SourcePlan.html">SourcePlan</a></li><li><a href="SourcePopulation.html">SourcePopulation</a></li><li><a href="Task.html">Task</a></li><li><a href="TransporterMemory.html">TransporterMemory</a></li><li><a href="UpgradeTask.html">UpgradeTask</a></li><li><a href="UpgraderMemory.html">UpgraderMemory</a></li></ul><h3>Tutorials</h3><ul><li><a href="tutorial-ARCHITECTURE.html">ARCHITECTURE</a></li><li><a href="tutorial-CHANGELOG.html">CHANGELOG</a></li><li><a href="tutorial-STYLE.html">STYLE</a></li><li><a href="tutorial-TODO.html">TODO</a></li></ul><h3>Global</h3><ul><li><a href="global.html#ATTACKER">ATTACKER</a></li><li><a href="global.html#BUILD">BUILD</a></li><li><a href="global.html#BUILDER">BUILDER</a></li><li><a href="global.html#CLAIMER">CLAIMER</a></li><li><a href="global.html#COLONY">COLONY</a></li><li><a href="global.html#CONSTRUCTION_TIMER_LENGTH">CONSTRUCTION_TIMER_LENGTH</a></li><li><a href="global.html#COUNT_POPULATION_TIMER_LENGTH">COUNT_POPULATION_TIMER_LENGTH</a></li><li><a href="global.html#DEBUG_MODE">DEBUG_MODE</a></li><li><a href="global.html#DRILLER">DRILLER</a></li><li><a href="global.html#EXPANSION">EXPANSION</a></li><li><a href="global.html#HEALER">HEALER</a></li><li><a href="global.html#HIGHWAY">HIGHWAY</a></li><li><a href="global.html#KEEPER_LAIR">KEEPER_LAIR</a></li><li><a href="global.html#LOG_SIZE">LOG_SIZE</a></li><li><a href="global.html#MINERAL_DRILLER">MINERAL_DRILLER</a></li><li><a href="global.html#MINERAL_TRANSPORTER">MINERAL_TRANSPORTER</a></li><li><a href="global.html#NEW_ROOM_TIMER_LENGTH">NEW_ROOM_TIMER_LENGTH</a></li><li><a href="global.html#PLANT_STRUCTURES_TIMER_LENGTH">PLANT_STRUCTURES_TIMER_LENGTH</a></li><li><a href="global.html#PRODUCTION_TIMER_LENGTH">PRODUCTION_TIMER_LENGTH</a></li><li><a href="global.html#QUEEN">QUEEN</a></li><li><a href="global.html#REACTION_TIMER_LENGTH">REACTION_TIMER_LENGTH</a></li><li><a href="global.html#REPAIRER">REPAIRER</a></li><li><a href="global.html#REQUEST_POPULATION_TIMER_LENGTH">REQUEST_POPULATION_TIMER_LENGTH</a></li><li><a href="global.html#ROLES">ROLES</a></li><li><a href="global.html#ROOM_CONSTRUCTION_SITE_LIMIT">ROOM_CONSTRUCTION_SITE_LIMIT</a></li><li><a href="global.html#RoomManager">RoomManager</a></li><li><a href="global.html#SATISFACTION_LOG_SIZE">SATISFACTION_LOG_SIZE</a></li><li><a href="global.html#SATISFACTION_THRESHOLD">SATISFACTION_THRESHOLD</a></li><li><a href="global.html#SCOUT">SCOUT</a></li><li><a href="global.html#STATES">STATES</a></li><li><a href="global.html#TASK_TYPES">TASK_TYPES</a></li><li><a href="global.html#TERMINAL_TIMER_LENGTH">TERMINAL_TIMER_LENGTH</a></li><li><a href="global.html#TRANSPORTER">TRANSPORTER</a></li><li><a href="global.html#UPGRADER">UPGRADER</a></li><li><a href="global.html#USERNAME">USERNAME</a></li><li><a href="global.html#hlog">hlog</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Tue Apr 15 2025 08:41:35 GMT-0500 (Central Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>